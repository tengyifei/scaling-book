<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Training LLaMA 3 on TPUs | How To Scale Your Model </title> <meta name="author" content=" "> <meta name="description" content="Let's take a close look at how we'd train LLaMA 3 models on TPU v5p using what we've learned in the previous section. How big are they? How expensive is training in different configurations? How are they sharded? Let's work through some back-of-the-envelope estimates for how the previous sections map onto real models."> <meta name="keywords" content="scaling, jax, llms, transformers, tpus, google, deepmind, parallelism, pallas"> <link rel="stylesheet" href="/scaling-book/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/scaling-book/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/scaling-book/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/scaling-book/assets/css/jekyll-pygments-themes-vs.css?4ee1a2facd1a8a76347f4bd43a740500" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/scaling-book/assets/img/favicon.png?fddbd8c2ec231ba2060e67c85de32a55"> <link rel="stylesheet" href="/scaling-book/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://jax-ml.github.io/scaling-book/applied-training/"> <script src="/scaling-book/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/scaling-book/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <script src="/scaling-book/assets/js/distillpub/template.v2.js"></script> <script src="/scaling-book/assets/js/distillpub/transforms.v2.js"></script> <style type="text/css">{{page._styles}}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Training LLaMA 3 on TPUs",
            "description": "Let's take a close look at how we'd train LLaMA 3 models on TPU v5p using what we've learned in the previous section. How big are they? How expensive is training in different configurations? How are they sharded? Let's work through some back-of-the-envelope estimates for how the previous sections map onto real models.",
            "published": "February 04, 2025",
            "authors": [
              
              {
                "author": "Jacob Austin",
                "authorURL": "https://www.jacobaustin.org/",
                "affiliations": [
                  {
                    "name": "Google DeepMind",
                    "url": ""
                  }
                ]
              },
              
              {
                "author": "Sholto Douglas",
                "authorURL": "https://x.com/_sholtodouglas",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },
              
              {
                "author": "Roy Frostig",
                "authorURL": "https://cs.stanford.edu/~rfrostig/",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },
              
              {
                "author": "Anselm Levskaya",
                "authorURL": "https://anselmlevskaya.com/",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },
              
              {
                "author": "Charlie Chen",
                "authorURL": "https://x.com/charliexychen",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },
              
              {
                "author": "Sharad Vikram",
                "authorURL": "https://sharadvikram.com/",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },
              
              {
                "author": "Federico Lebron",
                "authorURL": "https://fedelebron.com/",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },
              
              {
                "author": "Peter Choy",
                "authorURL": "https://x.com/pchoy95",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },
              
              {
                "author": "Vinay Ramasesh",
                "authorURL": "https://x.com/vinayramasesh",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },
              
              {
                "author": "Albert Webson",
                "authorURL": "https://representation.ai/",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },
              
              {
                "author": "Reiner Pope<sup>*</sup>",
                "authorURL": "https://x.com/reinerpope",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <script>
    function goToTop() {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    }

    // When the user scrolls down 20px from the top of the document, show the button
    window.onscroll = function() {scrollFunction()};

    function scrollFunction() {
      // Get the button:
      let mybutton = document.getElementById("top-button");

      if (document.body.scrollTop > 40 || document.documentElement.scrollTop > 40) {
        mybutton.style.display = "block";
      } else {
        mybutton.style.display = "none";
      }
  }
  </script> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/scaling-book"> How To Scale Your Model </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="left-button section-button"><a href="../training"><svg viewbox="-78.5 0 512 512"><path d="M257 64L291 98 128 262 291 426 257 460 61 262 257 64Z"></path></svg></a></div> <div class="right-button section-button"><a href="../inference"><svg viewbox="-78.5 0 512 512"><path d="M98 460L64 426 227 262 64 98 98 64 294 262 98 460Z"></path></svg></a></div> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/scaling-book/"> </a> </li> <li class="nav-item nav-hidden"><a class="nav-link" onclick="goToTop()" id="top-button" style="display: none;">Back to Top</a></li> <li class="nav-item nav-hidden"><p class="nav-link"></p></li> <li class="nav-item nav-hidden"><a class="nav-link" href="../training">Previous Part</a></li> <li class="nav-item nav-hidden"><a class="nav-link" href="../inference">Next Part</a></li> <li class="nav-item nav-hidden"><p class="nav-link"></p></li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Sections </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/scaling-book/index">Part 0. Introduction</a> <a class="dropdown-item " href="/scaling-book/roofline">Part 1. Intro to Rooflines</a> <a class="dropdown-item " href="/scaling-book/tpus">Part 2. All About TPUs</a> <a class="dropdown-item " href="/scaling-book/sharding">Part 3. Sharded Matmuls</a> <a class="dropdown-item " href="/scaling-book/transformers">Part 4. Transformers</a> <a class="dropdown-item " href="/scaling-book/training">Part 5. Training</a> <a class="dropdown-item " href="/scaling-book/applied-training">Part 6. Training LLaMA</a> <a class="dropdown-item " href="/scaling-book/inference">Part 7. Inference</a> <a class="dropdown-item " href="/scaling-book/applied-inference">Part 8. Serving LLaMA</a> <a class="dropdown-item " href="/scaling-book/profiling">Part 9. Profiling</a> <a class="dropdown-item " href="/scaling-book/jax-stuff">Part 10. All About JAX</a> <a class="dropdown-item " href="/scaling-book/conclusion">Part 11. Conclusions</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Training LLaMA 3 on TPUs</h1> <p>Part 6 of <a href="/scaling-book">How To Scale Your Model</a> (<a href="../training">Part 5: Training</a> | <a href="../inference">Part 7: Inference</a>)</p> <p>Let's take a close look at how we'd train LLaMA 3 models on TPU v5p using what we've learned in the previous section. How big are they? How expensive is training in different configurations? How are they sharded? Let's work through some back-of-the-envelope estimates for how the previous sections map onto real models.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#what-does-llama-3-look-like">What does LLaMA 3 look like?</a> </div> <div> <a href="#counting-parameters-and-flops">Counting parameters and FLOPs</a> </div> <div> <a href="#how-to-shard-llama-3-70b-for-training">How to shard LLaMA 3-70B for training</a> </div> <div> <a href="#worked-problems">Worked Problems</a> </div> </nav> </d-contents> <p><em>Our goal in this section is to apply results from the previous section to a very practical problem: training the LLaMA 3 family (herd) of models. Unlike the previous sections we want you to do a lot of this work yourself. For this reason, we’ve hidden the answers to each section so you can try to answer it first. Try grabbing a pen and doing by hand!</em></p> <h3 id="what-does-llama-3-look-like">What does LLaMA 3 look like?</h3> <p>The LLaMA-3 model family<d-cite key="llama3"></d-cite> includes 3 main models: LLaMA 3 8B, 70B, and 405B. We’ll mostly focus on 70B, and leave 8B and 405B for you to explore in the problem section at the end. Here’s the architecture for LLaMA 3-70B, taken from the LLaMA <a href="https://huggingface.co/meta-llama/Meta-Llama-3-70B/blob/main/config.json" rel="external nofollow noopener" target="_blank">HuggingFace page</a>.</p> <table> <thead> <tr> <th><strong>hyperparam</strong></th> <th><strong>value</strong></th> </tr> </thead> <tbody> <tr> <td>\(n_\text{layers}\) (L)</td> <td>80</td> </tr> <tr> <td>\(d_\text{model}\) (D)</td> <td>8,192</td> </tr> <tr> <td>\(d_{ff}\) (F)</td> <td>28,672</td> </tr> <tr> <td>\(n_\text{heads}\) (N)</td> <td>64</td> </tr> <tr> <td>\(n_\text{kv_heads}\) (K)</td> <td>8</td> </tr> <tr> <td>\(d_\text{qkv}\) (H)</td> <td>128</td> </tr> <tr> <td>\(n_\text{embeddings}\) (V)</td> <td>128,256</td> </tr> </tbody> </table> <p>To highlight how easy this is to find, here’s the config itself, along with a mapping:</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/scaling-book/assets/img/llama-json-480.webp 480w,/scaling-book/assets/img/llama-json-800.webp 800w,/scaling-book/assets/img/llama-json-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/scaling-book/assets/img/llama-json.png" class="img-fluid" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p><em>It’s useful to make a big table with these numbers for many different open-source LLMs, so you can quickly compare the design decisions they’ve made.</em></p> <h3 id="counting-parameters-and-flops">Counting parameters and FLOPs</h3> <p><strong>Question:</strong> From this table, can we calculate the LLaMA 3-70B parameter count? 🤫 Let’s apply the content of <a href="../transformers">Section 4</a> and see if we can get 70B!</p> <table> <thead> <tr> <th>param</th> <th>formula</th> <th>count</th> </tr> </thead> <tbody> <tr> <td>FFW params</td> <td>d_model * d_ff * 3 (for gelu + out-projection) * n_layers</td> <td>8,192 * 8,192 * 3.5 * 3 * 80 = <strong>56.3e9</strong> </td> </tr> <tr> <td>Vocab params</td> <td>2 (input and output embeddings) * n_embeddings * d_model</td> <td>2 * 128,256 * 8,192 = <strong>2.1e9</strong> </td> </tr> <tr> <td>Attention params</td> <td>n_layers * [ 2 (for q embedding and concatenated output projection) * d_model * n_heads * d_qkv + 2 (for k and v) * d_model * n_kv_heads * d_qkv]</td> <td>80 * (2 * 8,192 * 64 * 128 + 2 * 8,192 * 8 * 128) = <strong>12e9</strong> </td> </tr> <tr> <td> </td> <td> </td> <td>56.3e9 + 2.1e9 + 12e9 = <strong>70.4e9</strong> </td> </tr> </tbody> </table> <p>That’s great! We get the number we expect. You’ll notice as expected that the FFW parameters totally dominate the overall parameter count, although attention is non-trivial.</p> <p class="takeaway"><strong>Takeaway</strong>: The 3 big weight matrices in the MLP block are so much larger than all the other arrays in the Transformer that we can typically almost ignore all other parameters when reasoning about model memory or FLOPs. For LLaMA 3-70B, they represent 56B of 70B parameters.</p> <p>Let’s look at FLOPs now! <em>Remember the general rules for training from <a href="../transformers">Section 4</a>.</em></p> <p><strong>Question:</strong> How many FLOPs does LLaMA-3 perform per token per training step? <em>This helps us determine how expensive the whole training process will be.</em></p> <details><summary>Click here for the answer, once you’ve thought about it!</summary> <p><strong>Answer</strong>: As shown in <a href="../transformers">Section 4</a>, we do roughly \(6 \cdot \text{param count}\) FLOPs per token, so here that’s roughly <code class="language-plaintext highlighter-rouge">6 * 70e9 = 4.2e11</code> FLOPs / token. That’s about half a TFLOP per token per step. Assuming we’re compute-bound, this should take roughly <code class="language-plaintext highlighter-rouge">4.2e11 / 4.59E+14 = 1ms</code> on a single TPU v5p chip, assuming perfect FLOPs utilization.</p> </details> <p><strong>Question:</strong> LLaMA 3 was trained for about 15 trillion tokens. How many FLOPs is that total?</p> <details><summary>Click here for the answer, once you’ve thought about it!</summary> <p><strong>Answer</strong>: That’s easy, it’s just <code class="language-plaintext highlighter-rouge">4.2e11 * 15e12 = 6.3e24 FLOPs</code> total. 6.3 yottaFLOPs. That’s a lot! On a single TPU this would take <code class="language-plaintext highlighter-rouge">6.3e24 / 4.59E+14 = 435 years</code>. That’s also a lot!</p> </details> <p><strong>Question:</strong> Let’s say we wanted to train on a full TPU v5p pod with 16x20x28 = 8960 chips. How long would this take to train at 40% MFU in bfloat16, assuming we are compute-bound?</p> <details><summary>Click here for the answer, once you’ve thought about it!</summary> <p><strong>Answer</strong>: We know that each TPU v5p can perform 4.59e14 FLOPs / second. At 40% MFU, this will take about <code class="language-plaintext highlighter-rouge">T = 6.3e24 / (8960 * 4.59e14 * 0.4) = 3.8e6 seconds</code>. <strong>This is about 44 days!</strong> That’s fairly reasonable, assuming we can actually achieve 40% MFU.</p> </details> <p><strong>Question:</strong> LLaMA 3-70B was pretrained with a batch size of about 4M tokens. How many TPUs do we need at minimum to train with this batch size? <em>You can assume bfloat16 parameters and float32 optimizer state, and that you checkpoint gradients 4 times per layer.</em></p> <details><summary>Click here for the answer, once you’ve thought about it!</summary> <p><strong>Answer</strong>: This question is primarily asking about memory usage, since that’s the only strict constraint on available compute. During training, we have three primary uses of HBM: model parameters, optimizer state, and gradient checkpoints. If we assume bfloat16 weights, float32 optimizer state, and a <em>very</em> conservative gradient checkpointing scheme (3 times per layer), we have:</p> <table> <tbody> <tr> <td><strong>Params</strong></td> <td>2 * 70GB</td> <td>~140GB</td> </tr> <tr> <td><strong>Optimizer State</strong></td> <td>8 * 70GB</td> <td>~560GB</td> </tr> <tr> <td><strong>Gradient Checkpoints</strong></td> <td>2 * 8192 * 4e6 * 3 * 80</td> <td>~20.9TB</td> </tr> <tr> <td><strong>Total</strong></td> <td> </td> <td>~21.6TB</td> </tr> </tbody> </table> <p>The total here is about 21.6TB. You notice that gradient checkpointing strongly dominates the memory picture, even with a very conservative checkpointing scheme. We could technically go to 1 checkpoint per layer, or do microbatching, but this is a reasonable picture. With these assumptions, since each TPU v5p has 96GB of HBM, we need <code class="language-plaintext highlighter-rouge">21.6e12 / 96e9 = 225</code> TPUs. That’s not very much actually!</p> <p><em>Why wouldn’t we do this?</em> Well, because it would take us <code class="language-plaintext highlighter-rouge">44 days * 8960 / 171 = 1752 days</code> to train. That’s 6 and a half years. <strong>That’s a lot.</strong> Still, this makes it clear that we’re using these large clusters not because we’re bound by memory but rather because we need the extra FLOPs.</p> </details> <p><strong>Question:</strong> Under the same assumptions as the question above, if we use 8960 TPU v5p chips, how much memory will we use per-chip?</p> <details><summary>Click here for the answer, once you’ve thought about it!</summary> <p><strong>Answer</strong>: Our total memory is still about 21.6TB, so per-chip we’ll be using about 2.4GB per chip, which is bascially nothing. If we did much more aggressive checkpointing, e.g. 12 checkpoints per layer, we’d still only be at 8GB per chip. We’re nowhere near being memory bound during training at these scales.</p> </details> <p class="takeaway"><strong>Takeaways</strong>: It is technically possible to train even very large models on very small topologies, with the caveat that they will likely take a long time. Being able to calculate the total FLOPs of a training run allows us to ballpark its training time by assuming a modest MFU and a known topology.</p> <h3 id="how-to-shard-llama-3-70b-for-training">How to shard LLaMA 3-70B for training</h3> <p>Let’s stick to our setting from above and say we want to train LLaMA 3-70B with 4M token batch size (1024 sequences of length 8192 per batch) on a TPU v5p pod of 8960 chips. Let’s discuss what the best sharding strategy is for this model.</p> <p><strong>Question:</strong> Under the assumptions above, can we train our model with FSDP alone? To start, let’s say we can’t do any sequence/context parallelism. <em>This should be the first idea you have, since it’s simple and will introduce no extra communication if it works.</em></p> <details><summary>Click here for the answer, once you’ve thought about it!</summary> <p><strong>Answer</strong>: This answer will be a little pedantic. As noted above, LLaMA 3-70B is initially trained with sequences of length 4K, so the batch size of 4M tokens gives us a <em>sequence batch size</em> of 1024. That means we can only really do pure data parallelism/FSDP up to 1024 chips <em>because that’s how many sequences we have to do data parallelism over</em>. So the answer in the simple sense of “fully data parallelism with no extra communication” is no. The next question will answer a slightly less pedantic version of this.</p> </details> <p><strong>Question:</strong> Let’s relax the requirement of not doing any sequence sharding. If we allow ourselves to do FSDP over both the batch <em>and</em> sequence axes, can we train LLaMA 3-70B with only FSDP on 8960 chips?</p> <details><summary>Click here for the answer, once you’ve thought about it!</summary> <p><strong>Answer</strong>: Now that we’re allowing ourselves to do sequence/context parallelism as well, we can scale up way more. First let’s calculate our per-device batch size. If we do 8960-way FSDP, we end with a per-TPU batch size of <code class="language-plaintext highlighter-rouge">4 * 1024 * 1024 / 8960 = 468 tokens</code>. We know from the previous section that we become ICI-bound by FSDP when \(\text{per device batch size} &lt; 2550 / n_\text{axes}\). Since we can dedicate 3 axes here with a full 3D pod, this would give us a lower bound of 850, which we’re well below. <strong>So the answer is no, even with 3 axes. We would be solidly communication-bound.</strong></p> </details> <p><strong>Question:</strong> Now let’s look at mixed tensor parallelism and FSDP. Does there exist some combination that lets us remain compute-bound? What amount of FSDP and tensor parallelism should we do if so?</p> <details><summary>Click here for the answer, once you’ve thought about it!</summary> <p><strong>Answer</strong>: First let’s check to see if this will even fit. We know that we’ll be comms-bound if our per-chip batch size is less than \(2 \cdot 2550^2 / F = 453\). As we saw above, we’re slightly above this. So that’s great! Now to pick the optimal amount of FSDP, we can use the formula</p> \[X_{opt} = \sqrt{\frac{2BN}{F}} = \sqrt{\frac{2 \cdot 4.19e6 \cdot 8960}{28672}} = 1618\] <p>Rounding to a reasonable multiple of 2, that gives us roughly 2048-way FSDP and 4-way model parallelism. That should work well!</p> </details> <p class="takeaway"><strong>Takeaways</strong>: We can train LLaMA-3 with a 4M token batch size on a full TPU v5p pod with a mixture of data parallelism (1024-way), sequence parallelism (2-way), and tensor parallelism (4-way) without being communication-bound. We will be comms-bound if we try to do pure FSDP or FSDP + sequence parallelism. The equations we’ve cooked up in the previous section are very practical.</p> <h2 id="worked-problems">Worked Problems</h2> <p><strong>Question 1 [Scaling LLaMA 70B to more chips]:</strong> say we want to train LLaMA 3-70B on 4 pods with the same batch size. What parallelism scheme would we use? Would we be compute or communication bound? Roughly how long would it take to train? <em>Make sure to use the correct roofline bound.</em></p> <p><strong>Question 2 [LLaMA 405B]:</strong></p> <p>(a) Using the LLaMA 3-405B <a href="https://huggingface.co/meta-llama/Llama-3.1-405B/blob/main/config.json" rel="external nofollow noopener" target="_blank">config</a>, write a table with all the key hyperparameters as above. How many total parameters does this model have? How many FLOPs per training step? How many FLOPs do we perform if we train for 15T tokens?</p> <p>(b) Assume we want to train on 8 TPU v5p pods. What parallelism scheme would we use? How long would training take? Would be compute or comms bound?</p> <h3 class="next-section">That’s all for Section 6. For Section 7, about Transformer inference, click <a href="../inference">here</a>.</h3> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> <div class="base-grid appendix-entry"> <h3 style="grid-column: 0;">Miscellaneous</h3> <p class="author-footnote" style="grid-column: text;"><sup>*</sup>Work done at Google DeepMind, now at MatX.</p> </div> <div class="base-grid appendix-entry"> <h3 style="grid-column: 0;">Citation</h3> <p class="author-footnote">For attribution in academic contexts, please cite this work as:</p> <div class="author-footnote"> <div class="language-bibtex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c">Austin et al., "How to Scale Your Model", Google DeepMind, online, 2025.</span>
</code></pre></div></div> </div> <p class="author-footnote">or as a BibTeX entry:</p> <div class="author-footnote"> <div class="language-bibtex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nc">@article</span><span class="p">{</span><span class="nl">scaling-book</span><span class="p">,</span>
      <span class="na">title</span> <span class="p">=</span> <span class="s">{How to Scale Your Model}</span><span class="p">,</span>
      <span class="na">author</span> <span class="p">=</span> <span class="s">{Austin, Jacob and Douglas, Sholto and Frostig, Roy and Levskaya, Anselm and Chen, Charlie and Vikram, Sharad
      and Lebron, Federico and Choy, Peter and Ramasesh, Vinay and Webson, Albert and Pope, Reiner}</span><span class="p">,</span>
      <span class="na">publisher</span> <span class="p">=</span> <span class="s">{Google DeepMind}</span><span class="p">,</span>
      <span class="na">howpublished</span> <span class="p">=</span> <span class="s">{Online}</span><span class="p">,</span>
      <span class="na">note</span> <span class="p">=</span> <span class="s">{Retrieved from https://jax-ml.github.io/scaling-book/}</span><span class="p">,</span>
      <span class="na">year</span> <span class="p">=</span> <span class="s">{2025}</span>
    <span class="p">}</span>
</code></pre></div></div> </div> </div> </d-appendix> <d-bibliography src="/scaling-book/assets/bibliography/main.bib"></d-bibliography> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'jax-ml/scaling-book',
        'data-repo-id': '',
        'data-category': 'General',
        'data-category-id': '',
        'data-mapping': 'title',
        'data-strict': '0',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': giscusTheme,
        'data-loading': '1',
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/scaling-book/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/scaling-book/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/scaling-book/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/scaling-book/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/scaling-book/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/scaling-book/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/scaling-book/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/scaling-book/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/scaling-book/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>